<!DOCTYPE html>
<html xmlns:th="https://thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Search Centers</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>

<h2>Search Centers</h2>

<div class="mb-3">
    <input type="text" id="searchInput" class="form-control" placeholder="Search by name">
</div>

<div class="mb-3">
    <label for="addressFilter">Filter by Address:</label>
    <input type="text" id="addressFilter" class="form-control" placeholder="Enter address">
</div>

<table class="table" id="centerTable">
    <thead>
    <tr>
        <th>Center Name</th>
        <th>Email</th>
        <th>Address</th>
        <th>Location</th>
    </tr>
    </thead>
    <tbody>
    </tbody>
</table>

<script th:inline="javascript">
    $(document).ready(function() {
        let centers = [];

        // Fetch centers initially
        $.ajax({
            url: "/api/exams/centers", // Replace with your actual API endpoint for fetching centers
            success: function(data) {
                centers = data;
                updateCenterTable();
            },
            error: function(error) {
                alert("Error fetching centers.");
            }
        });

        $("#searchInput, #addressFilter").on("input", updateCenterTable);

        function updateCenterTable() {
            const searchText = $("#searchInput").val().toLowerCase();
            const addressFilter = $("#addressFilter").val().toLowerCase();

            const filteredCenters = centers.filter(center => {
                const matchesSearch = center.name.toLowerCase().includes(searchText);
                const matchesAddress = !addressFilter || center.address.toLowerCase().includes(addressFilter);
                return matchesSearch && matchesAddress;
            });

            const tableBody = $("#centerTable tbody");
            tableBody.empty();
            filteredCenters.forEach(center => {
                tableBody.append(`<tr>
                    <td>${center.name}</td>
                    <td>${center.email}</td>
                    <td>${center.address}</td>
                    <td>${center.location}</td>
                </tr>`);
            });
        }
    });
</script>

</body>
</html>
